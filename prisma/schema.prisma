generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model user {
  user_id        String          @id @default(uuid())
  email          String          @unique
  name           String
  notes          note[]
  courses        course[]
  subjects       subject[]
  pyqs           pyq[]
  note_upvotes   note_upvote[]
  course_upvotes course_upvote[]
  pyq_upvotes    pyq_upvote[]
}

model subject {
  id            Int      @id @unique @default(autoincrement())
  code          String   @unique
  name          String   @db.VarChar(255)
  created_by    user     @relation(fields: [created_by_id], references: [user_id], onDelete: Restrict)
  created_by_id String
  created_at    DateTime @default(now())
  updated_at    DateTime @updatedAt
  notes         note[]
}

model note {
  id            Int           @id @unique @default(autoincrement())
  title         String        @db.VarChar(255)
  url           String        @db.VarChar(255)
  subjects      subject       @relation(fields: [subject], references: [code])
  subject       String        @db.VarChar(255)
  batch         String        @db.VarChar(255)
  branch        String        @db.VarChar(255)
  class         String        @db.VarChar(100)
  anonymous     Boolean
  created_by    user          @relation(fields: [created_by_id], references: [user_id], onDelete: Restrict)
  created_by_id String
  created_at    DateTime      @default(now())
  updated_at    DateTime      @updatedAt
  upvotes       note_upvote[]
}

model note_upvote {
  id      Int    @id @unique @default(autoincrement())
  users   user   @relation(fields: [user_id], references: [user_id], onDelete: Restrict)
  user_id String @unique
  notes   note   @relation(fields: [note_id], references: [id], onDelete: Restrict)
  note_id Int    @unique
}

model course {
  id            Int             @id @unique @default(autoincrement())
  title         String          @db.VarChar(255)
  anonymous     Boolean
  created_by    user            @relation(fields: [created_by_id], references: [user_id], onDelete: Restrict)
  created_by_id String
  created_at    DateTime        @default(now())
  updated_at    DateTime        @updatedAt
  upvotes       course_upvote[]
}

model course_upvote {
  id        Int    @id @unique @default(autoincrement())
  user      user   @relation(fields: [user_id], references: [user_id], onDelete: Restrict)
  user_id   String @unique
  course    course @relation(fields: [course_id], references: [id], onDelete: Restrict)
  course_id Int    @unique
}

model pyq {
  id            Int          @id @unique @default(autoincrement())
  subject       String       @db.VarChar(255)
  batch         String       @db.VarChar(255)
  branch        String       @db.VarChar(255)
  year          String       @db.VarChar(100)
  anonymous     Boolean
  created_by    user         @relation(fields: [created_by_id], references: [user_id], onDelete: Restrict)
  created_by_id String
  created_at    DateTime     @default(now())
  updated_at    DateTime     @updatedAt
  upvotes       pyq_upvote[]
}

model pyq_upvote {
  id      Int    @id @unique @default(autoincrement())
  user    user   @relation(fields: [user_id], references: [user_id], onDelete: Restrict)
  user_id String @unique
  pyq     pyq    @relation(fields: [pyq_id], references: [id], onDelete: Restrict)
  pyq_id  Int    @unique
}
